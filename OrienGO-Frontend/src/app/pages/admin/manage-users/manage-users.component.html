<div class="min-h-screen bg-orange-50 py-8 px-2 smaller:px-4 sm:px-6 lg:px-8">
  <div class="max-w-[88rem] mx-auto">

    <!-- Header Section -->
    <div class="text-center mb-12">
      <!-- User Icon -->
      <div class="w-20 h-20 sm:w-[86px] sm:h-[86px] md:w-24 md:h-24 inline-flex items-center justify-center bg-orange-500 rounded-full mb-4">
        <svg class="w-14 h-14 sm:w-16 sm:h-16 md:w-[68px] md:h-[68px] text-white" viewBox="0 0 24.00 24.00" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff" stroke-width="0.36"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M9 1.25C6.37665 1.25 4.25 3.37665 4.25 6C4.25 8.62335 6.37665 10.75 9 10.75C11.6234 10.75 13.75 8.62335 13.75 6C13.75 3.37665 11.6234 1.25 9 1.25ZM5.75 6C5.75 4.20507 7.20507 2.75 9 2.75C10.7949 2.75 12.25 4.20507 12.25 6C12.25 7.79493 10.7949 9.25 9 9.25C7.20507 9.25 5.75 7.79493 5.75 6Z" fill="#ffffff"></path> <path d="M15 2.25C14.5858 2.25 14.25 2.58579 14.25 3C14.25 3.41421 14.5858 3.75 15 3.75C16.2426 3.75 17.25 4.75736 17.25 6C17.25 7.24264 16.2426 8.25 15 8.25C14.5858 8.25 14.25 8.58579 14.25 9C14.25 9.41421 14.5858 9.75 15 9.75C17.0711 9.75 18.75 8.07107 18.75 6C18.75 3.92893 17.0711 2.25 15 2.25Z" fill="#ffffff"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M3.67815 13.5204C5.07752 12.7208 6.96067 12.25 9 12.25C11.0393 12.25 12.9225 12.7208 14.3219 13.5204C15.7 14.3079 16.75 15.5101 16.75 17C16.75 18.4899 15.7 19.6921 14.3219 20.4796C12.9225 21.2792 11.0393 21.75 9 21.75C6.96067 21.75 5.07752 21.2792 3.67815 20.4796C2.3 19.6921 1.25 18.4899 1.25 17C1.25 15.5101 2.3 14.3079 3.67815 13.5204ZM4.42236 14.8228C3.26701 15.483 2.75 16.2807 2.75 17C2.75 17.7193 3.26701 18.517 4.42236 19.1772C5.55649 19.8253 7.17334 20.25 9 20.25C10.8267 20.25 12.4435 19.8253 13.5776 19.1772C14.733 18.517 15.25 17.7193 15.25 17C15.25 16.2807 14.733 15.483 13.5776 14.8228C12.4435 14.1747 10.8267 13.75 9 13.75C7.17334 13.75 5.55649 14.1747 4.42236 14.8228Z" fill="#ffffff"></path> <path d="M18.1607 13.2674C17.7561 13.1787 17.3561 13.4347 17.2674 13.8393C17.1787 14.2439 17.4347 14.6439 17.8393 14.7326C18.6317 14.9064 19.2649 15.2048 19.6829 15.5468C20.1014 15.8892 20.25 16.2237 20.25 16.5C20.25 16.7507 20.1294 17.045 19.7969 17.3539C19.462 17.665 18.9475 17.9524 18.2838 18.1523C17.8871 18.2717 17.6624 18.69 17.7818 19.0867C17.9013 19.4833 18.3196 19.708 18.7162 19.5886C19.5388 19.3409 20.2743 18.9578 20.8178 18.4529C21.3637 17.9457 21.75 17.2786 21.75 16.5C21.75 15.6352 21.2758 14.912 20.6328 14.3859C19.9893 13.8593 19.1225 13.4783 18.1607 13.2674Z" fill="#ffffff"></path> </g></svg>
      </div>
      
      <h1 class="text-sm xxs:text-base xs:text-xl smaller:text-2xl sm:text-4xl font-bold text-gray-800 mb-4">
        {{ 'ADMIN_USERS.TITLE' | translate }}
      </h1>
      <p class="text-gray-600 text-base sm:text-lg mb-8 max-w-xl sm:max-w-2xl mx-auto sm:px-0">
        {{ 'ADMIN_USERS.SUBTITLE' | translate }}
      </p>
    </div>

    <!-- Search and Filters -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (input)="onSearchChange()"
        placeholder="{{ 'ADMIN_USERS.SEARCH_PLACEHOLDER' | translate }}"
        class="outline-none px-4 py-3 border border-gray-300 rounded-lg focus:ring-1 focus:ring-brand-orange focus:border-brand-orange transition-colors"
      />
      <select 
        [(ngModel)]="selectedRole"
        (change)="onRoleChange()"
        class="cursor-pointer px-4 py-3 border border-gray-300 rounded-lg focus:ring-1 focus:ring-brand-orange focus:border-brand-orange transition-colors bg-white">
        <option value="">{{ 'ADMIN_USERS.FILTER_ROLE' | translate }}</option>
        <option value="student">Student</option>
        <option value="coach">Coach</option>
      </select>
      <select 
        [(ngModel)]="selectedStatus"
        (change)="onStatusChange()"
        class="cursor-pointer px-4 py-3 border border-gray-300 rounded-lg focus:ring-1 focus:ring-brand-orange focus:border-brand-orange transition-colors bg-white">
        <option value="">{{ 'ADMIN_USERS.FILTER_STATUS' | translate }}</option>
        <option value="active">Active</option>
        <option value="inactive">Inactive</option>
      </select>
      <input
        type="date"
        [(ngModel)]="selectedDate"
        (change)="onDateChange()"
        class="cursor-pointer outline-none px-4 py-3 border border-gray-300 rounded-lg focus:ring-1 focus:ring-brand-orange focus:border-brand-orange transition-colors"
        placeholder="{{ 'ADMIN_USERS.FILTER_DATE' | translate }}"
      />
    </div>

    <!-- Action Buttons -->
    <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
      <button
        (click)="resetFilters()"
        class="px-4 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-medium transition-colors">
        {{ 'ADMIN_USERS.RESET_FILTERS' | translate }}
      </button>
      <button 
        (click)="openAddUserModal()"
        class="px-6 py-3 bg-brand-orange hover:bg-orange-600 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transform transition-all">
        + {{ 'ADMIN_USERS.ADD_BUTTON' | translate }}
      </button>
    </div>

    <!-- Table -->
    <div class="overflow-x-auto bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200">
      <table class="min-w-full text-left text-sm">
        <thead class="bg-orange-100">
          <tr class="border-b border-gray-200">
            <th 
              (click)="onSort('firstName')"
              class="px-6 py-4 text-left text-sm font-semibold text-gray-700 hover:bg-orange-200 transition-colors cursor-pointer select-none">
              {{ 'ADMIN_USERS.TABLE.NAME' | translate }}
              <span *ngIf="sortField === 'firstName'" class="ml-1">
                {{ sortDirection === 'asc' ? '↑' : '↓' }}
              </span>
            </th>
            <th 
              (click)="onSort('email')"
              class="px-6 py-4 text-left text-sm font-semibold text-gray-700 hover:bg-orange-200 transition-colors cursor-pointer select-none">
              {{ 'ADMIN_USERS.TABLE.EMAIL' | translate }}
              <span *ngIf="sortField === 'email'" class="ml-1">
                {{ sortDirection === 'asc' ? '↑' : '↓' }}
              </span>
            </th>
            <th 
              (click)="onSort('role')"
              class="px-6 py-4 text-left text-sm font-semibold text-gray-700 hover:bg-orange-200 transition-colors cursor-pointer select-none">
              {{ 'ADMIN_USERS.TABLE.ROLE' | translate }}
              <span *ngIf="sortField === 'role'" class="ml-1">
                {{ sortDirection === 'asc' ? '↑' : '↓' }}
              </span>
            </th>
            <th 
              (click)="onSort('status')"
              class="px-6 py-4 text-left text-sm font-semibold text-gray-700 hover:bg-orange-200 transition-colors cursor-pointer select-none">
              {{ 'ADMIN_USERS.TABLE.STATUS' | translate }}
              <span *ngIf="sortField === 'status'" class="ml-1">
                {{ sortDirection === 'asc' ? '↑' : '↓' }}
              </span>
            </th>
            <th 
              (click)="onSort('createdAt')"
              class="px-6 py-4 text-left text-sm font-semibold text-gray-700 hover:bg-orange-200 transition-colors cursor-pointer select-none">
              {{ 'ADMIN_USERS.TABLE.CREATED' | translate }}
              <span *ngIf="sortField === 'createdAt'" class="ml-1">
                {{ sortDirection === 'asc' ? '↑' : '↓' }}
              </span>
            </th>
            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">{{ 'ADMIN_USERS.TABLE.ACTIONS' | translate }}</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <tr *ngFor="let user of users" class="hover:bg-orange-50 transition-colors">
            <td class="px-6 py-4">
              <div>
                <div class="font-semibold text-gray-900">{{ user.firstName }} {{ user.lastName }}</div>
                <div class="text-sm text-gray-500 mt-1">{{ user.role === 'student' ? 'Student' : 'Coach' }}</div>
              </div>
            </td>
            <td class="px-6 py-4 text-gray-900">{{ user.email }}</td>
            <td class="px-6 py-4">
              <span class="bg-brand-orange text-white px-3 py-1 rounded-full text-xs font-medium">
                {{ user.role === 'student' ? 'Student' : 'Coach' }}
              </span>
            </td>
            <td class="px-6 py-4">
              <span [class]="user.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'" 
                    class="px-3 py-1 rounded-full text-xs font-medium">
                {{ user.status === 'active' ? 'Active' : 'Inactive' }}
              </span>
            </td>
            <td class="px-6 py-4 text-gray-900">{{ user.createdAt }}</td>
            <td class="px-6 py-4">
              <span 
                (click)="openViewUserModal(user)"
                class="text-brand-orange-dark hover:text-orange-700 cursor-pointer font-medium hover:underline transition-colors">
                {{ 'ADMIN_USERS.ACTIONS.VIEW' | translate }}
              </span>
              <span class="text-gray-300 mx-2">|</span>
              <span 
                (click)="openEditUserModal(user)"
                class="text-green-600 hover:text-green-700 cursor-pointer font-medium hover:underline transition-colors">
                {{ 'ADMIN_USERS.ACTIONS.EDIT' | translate }}
              </span>
              <span class="text-gray-300 mx-2">|</span>
              <span 
                (click)="deleteUser(user)"
                class="text-red-600 hover:text-red-700 cursor-pointer font-medium hover:underline transition-colors">
                {{ 'ADMIN_USERS.ACTIONS.DELETE' | translate }}
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Add User Modal -->
  <div *ngIf="showAddUserModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
    <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
      <div class="p-6">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-semibold text-gray-800">
            {{ 'ADMIN_USERS.MODAL.ADD_TITLE' | translate }}
          </h3>
          <button 
            (click)="closeAddUserModal()"
            class="text-gray-400 hover:text-gray-600 text-2xl">
            ×
          </button>
        </div>

        <form [formGroup]="addUserForm" (ngSubmit)="onSubmit()" class="space-y-4">
          <!-- Informations de base -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">
                {{ 'ADMIN_USERS.MODAL.FIRST_NAME' | translate }} *
              </label>
              <input
                type="text"
                formControlName="firstName"
                [class.border-red-500]="addUserForm.get('firstName')?.invalid && addUserForm.get('firstName')?.touched"
                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                [placeholder]="'ADMIN_USERS.MODAL.FIRST_NAME_PLACEHOLDER' | translate"
              />
              <div *ngIf="getErrorMessage('firstName', addUserForm)" class="text-red-500 text-xs mt-1">
                {{ getErrorMessage('firstName', addUserForm) }}
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">
                {{ 'ADMIN_USERS.MODAL.LAST_NAME' | translate }} *
              </label>
              <input
                type="text"
                formControlName="lastName"
                [class.border-red-500]="addUserForm.get('lastName')?.invalid && addUserForm.get('lastName')?.touched"
                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                [placeholder]="'ADMIN_USERS.MODAL.LAST_NAME_PLACEHOLDER' | translate"
              />
              <div *ngIf="getErrorMessage('lastName', addUserForm)" class="text-red-500 text-xs mt-1">
                {{ getErrorMessage('lastName', addUserForm) }}
              </div>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">
                {{ 'ADMIN_USERS.MODAL.EMAIL' | translate }} *
              </label>
              <input
                type="email"
                formControlName="email"
                [class.border-red-500]="addUserForm.get('email')?.invalid && addUserForm.get('email')?.touched"
                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                [placeholder]="'ADMIN_USERS.MODAL.EMAIL_PLACEHOLDER' | translate"
              />
              <div *ngIf="getErrorMessage('email', addUserForm)" class="text-red-500 text-xs mt-1">
                {{ getErrorMessage('email', addUserForm) }}
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">
                {{ 'ADMIN_USERS.MODAL.ROLE' | translate }} *
              </label>
              <select
                formControlName="role"
                class="cursor-pointer bg-white w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                <option *ngFor="let role of getAvailableRoles()" [value]="role">
                  {{ role === 'student' ? 'Student' : 'Coach' }}
                </option>
              </select>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">
                {{ 'ADMIN_USERS.MODAL.PASSWORD' | translate }} *
              </label>
              <input
                type="password"
                formControlName="password"
                [class.border-red-500]="addUserForm.get('password')?.invalid && addUserForm.get('password')?.touched"
                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                [placeholder]="'ADMIN_USERS.MODAL.PASSWORD_PLACEHOLDER' | translate"
              />
              <div *ngIf="getErrorMessage('password', addUserForm)" class="text-red-500 text-xs mt-1">
                {{ getErrorMessage('password', addUserForm) }}
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">
                {{ 'ADMIN_USERS.MODAL.CONFIRM_PASSWORD' | translate }} *
              </label>
              <input
                type="password"
                formControlName="confirmPassword"
                [class.border-red-500]="addUserForm.get('confirmPassword')?.invalid && addUserForm.get('confirmPassword')?.touched"
                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                [placeholder]="'ADMIN_USERS.MODAL.CONFIRM_PASSWORD_PLACEHOLDER' | translate"
              />
              <div *ngIf="addUserForm.errors?.['passwordMismatch'] && addUserForm.get('confirmPassword')?.touched" class="text-red-500 text-xs mt-1">
                {{ 'ADMIN_USERS.MODAL.PASSWORD_MISMATCH' | translate }}
              </div>
            </div>
          </div>

          <!-- Champs communs pour tous les rôles -->
          <div class="border-t pt-4">
            <h4 class="text-lg font-medium text-gray-800 mb-4">
              {{ 'ADMIN_USERS.MODAL.PERSONAL_INFO' | translate }}
            </h4>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.AGE' | translate }}
                </label>
                <input
                  type="number"
                  min="0"
                  max="100"
                  formControlName="age"
                  [class.border-red-500]="addUserForm.get('age')?.invalid && addUserForm.get('age')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.AGE_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('age', addUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('age', addUserForm) }}
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.GENDER' | translate }}
                </label>
                <select
                  formControlName="gender"
                  [ngClass]="{'text-gray-400': !addUserForm.get('gender')?.value}"
                  class="cursor-pointer bg-white w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                  <option [ngValue]="null" disabled selected hidden>{{ 'ADMIN_USERS.MODAL.SELECT_GENDER' | translate }}</option>
                  <option value="male">{{ 'ADMIN_USERS.MODAL.MALE' | translate }}</option>
                  <option value="female">{{ 'ADMIN_USERS.MODAL.FEMALE' | translate }}</option>
                  <option value="other">{{ 'ADMIN_USERS.MODAL.OTHER' | translate }}</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.PHONE_NUMBER' | translate }}
                </label>
                <input
                  type="tel"
                  formControlName="phoneNumber"
                  [class.border-red-500]="addUserForm.get('phoneNumber')?.invalid && addUserForm.get('phoneNumber')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.PHONE_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('phoneNumber', addUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('phoneNumber', addUserForm) }}
                </div>
              </div>
            </div>
          </div>

          <!-- Champs spécifiques aux étudiants -->
          <div *ngIf="isStudentRole()" class="border-t pt-4">
            <h4 class="text-lg font-medium text-gray-800 mb-4">
              {{ 'ADMIN_USERS.MODAL.STUDENT_INFO' | translate }}
            </h4>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.SCHOOL' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="school"
                  [class.border-red-500]="addUserForm.get('school')?.invalid && addUserForm.get('school')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.SCHOOL_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('school', addUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('school', addUserForm) }}
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.FIELD_OF_STUDY' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="fieldOfStudy"
                  [class.border-red-500]="addUserForm.get('fieldOfStudy')?.invalid && addUserForm.get('fieldOfStudy')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.FIELD_OF_STUDY_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('fieldOfStudy', addUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('fieldOfStudy', addUserForm) }}
                </div>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.EDUCATION_LEVEL_LABEL' | translate }} *
                </label>
                <select
                  formControlName="educationLevel"
                  [ngClass]="{'text-gray-400': !addUserForm.get('educationLevel')?.value}"
                  class="cursor-pointer bg-white w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                  <option value="" disabled selected hidden>{{ 'ADMIN_USERS.MODAL.SELECT_EDUCATION_LEVEL' | translate }}</option>
                  <option *ngFor="let level of educationLevels" [value]="level">
                    {{ getEducationLevelLabel(level) }}
                  </option>
                </select>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.CITY' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="city"
                  [class.border-red-500]="addUserForm.get('city')?.invalid && addUserForm.get('city')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.CITY_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('city', addUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('city', addUserForm) }}
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.REGION' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="region"
                  [class.border-red-500]="addUserForm.get('region')?.invalid && addUserForm.get('region')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.REGION_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('region', addUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('region', addUserForm) }}
                </div>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.COUNTRY' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="country"
                  [class.border-red-500]="addUserForm.get('country')?.invalid && addUserForm.get('country')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.COUNTRY_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('country', addUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('country', addUserForm) }}
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.ADDRESS' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="address"
                  [class.border-red-500]="addUserForm.get('address')?.invalid && addUserForm.get('address')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.ADDRESS_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('address', addUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('address', addUserForm) }}
                </div>
              </div>
            </div>
          </div>

          <!-- Champs de permissions pour tous les rôles -->
          <div class="border-t pt-4">
            <h4 class="text-lg font-medium text-gray-800 mb-4">
              {{ 'ADMIN_USERS.MODAL.PERMISSIONS' | translate }}
            </h4>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.MESSAGE_PERMISSION_LABEL' | translate }}
                </label>
                <select
                  formControlName="messagePermission"
                  [ngClass]="{'text-gray-400': !addUserForm.get('messagePermission')?.value}"                  
                  class="cursor-pointer bg-white w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                  <option value="" disabled selected hidden>{{ 'ADMIN_USERS.MODAL.SELECT_PERMISSION' | translate }}</option>
                  <option *ngFor="let permission of messagePermissions" [value]="permission">
                    {{ getMessagePermissionLabel(permission) }}
                  </option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.ACCOUNT_PRIVACY_LABEL' | translate }}
                </label>
                <select
                  formControlName="accountPrivacy"
                  [ngClass]="{'text-gray-400': !addUserForm.get('accountPrivacy')?.value}"                  
                  class="cursor-pointer bg-white w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                  <option value="" disabled selected hidden>{{ 'ADMIN_USERS.MODAL.SELECT_ACCOUNT_PRIVACY' | translate }}</option>
                  <option *ngFor="let privacy of accountPrivacies" [value]="privacy">
                    {{ getAccountPrivacyLabel(privacy) }}
                  </option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.PROFILE_VISIBILITY_LABEL' | translate }}
                </label>
                <select
                  formControlName="profileVisibility"
                  [ngClass]="{'text-gray-400': !addUserForm.get('profileVisibility')?.value}"
                  class="cursor-pointer bg-white w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                  <option value="" disabled selected hidden>{{ 'ADMIN_USERS.MODAL.SELECT_PROFILE_VISIBILITY' | translate }}</option>
                  <option *ngFor="let visibility of visibilityStatuses" [value]="visibility">
                    {{ getVisibilityStatusLabel(visibility) }}
                  </option>
                </select>
              </div>
            </div>
          </div>

          <!-- Boutons -->
          <div class="flex justify-end space-x-3 pt-6 border-t">
            <button
              type="button"
              (click)="closeAddUserModal()"
              class="px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50">
              {{ 'ADMIN_USERS.MODAL.CANCEL' | translate }}
            </button>
            <button
              type="submit"
              [disabled]="addUserForm.invalid"
              class="px-4 py-2 bg-brand-orange-dark text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 font-medium transition-colors">
              {{ 'ADMIN_USERS.MODAL.ADD' | translate }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- View User Modal -->
  <div *ngIf="showViewUserModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
    <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
      <div class="p-6">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-semibold text-gray-800">
            {{ 'ADMIN_USERS.MODAL.VIEW_TITLE' | translate }}
          </h3>
          <button 
            (click)="closeViewUserModal()"
            class="text-gray-400 hover:text-gray-600 text-2xl">
            ×
          </button>
        </div>

        <div *ngIf="selectedUser" class="space-y-6">
          <!-- Informations de base -->
          <div>
            <h4 class="text-lg font-medium text-gray-800 mb-4">
              {{ 'ADMIN_USERS.MODAL.BASIC_INFO' | translate }}
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.FIRST_NAME' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.firstName }}</p>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.LAST_NAME' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.lastName }}</p>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.EMAIL' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.email }}</p>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.ROLE' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.role === 'student' ? 'Student' : 'Coach' }}</p>
              </div>
            </div>
          </div>

          <!-- Informations personnelles -->
          <div class="border-t pt-4">
            <h4 class="text-lg font-medium text-gray-800 mb-4">
              {{ 'ADMIN_USERS.MODAL.PERSONAL_INFO' | translate }}
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div *ngIf="selectedUser.age">
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.AGE' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.age }}</p>
              </div>
              <div *ngIf="selectedUser.gender">
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.GENDER' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.gender }}</p>
              </div>
              <div *ngIf="selectedUser.phoneNumber">
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.PHONE_NUMBER' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.phoneNumber }}</p>
              </div>
            </div>
          </div>

          <!-- Informations spécifiques aux étudiants -->
          <div *ngIf="selectedUser.role === 'student'" class="border-t pt-4">
            <h4 class="text-lg font-medium text-gray-800 mb-4">
              {{ 'ADMIN_USERS.MODAL.STUDENT_INFO' | translate }}
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div *ngIf="selectedUser.school">
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.SCHOOL' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.school }}</p>
              </div>
              <div *ngIf="selectedUser.fieldOfStudy">
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.FIELD_OF_STUDY' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.fieldOfStudy }}</p>
              </div>
              <div *ngIf="selectedUser.educationLevel">
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.EDUCATION_LEVEL_LABEL' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.educationLevel }}</p>
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
              <div *ngIf="selectedUser.city">
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.CITY' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.city }}</p>
              </div>
              <div *ngIf="selectedUser.region">
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.REGION' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.region }}</p>
              </div>
              <div *ngIf="selectedUser.country">
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.COUNTRY' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.country }}</p>
              </div>
              <div *ngIf="selectedUser.address">
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.ADDRESS' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.address }}</p>
              </div>
            </div>
          </div>

          <!-- Permissions -->
          <div class="border-t pt-4">
            <h4 class="text-lg font-medium text-gray-800 mb-4">
              {{ 'ADMIN_USERS.MODAL.PERMISSIONS' | translate }}
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div *ngIf="selectedUser.messagePermission">
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.MESSAGE_PERMISSION_LABEL' | translate }}</label>
                <p class="text-gray-900">{{ getMessagePermissionLabel(selectedUser.messagePermission) }}</p>
              </div>
              <div *ngIf="selectedUser.accountPrivacy">
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.ACCOUNT_PRIVACY_LABEL' | translate }}</label>
                <p class="text-gray-900">{{ getAccountPrivacyLabel(selectedUser.accountPrivacy) }}</p>
              </div>
              <div *ngIf="selectedUser.profileVisibility">
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.PROFILE_VISIBILITY_LABEL' | translate }}</label>
                <p class="text-gray-900">{{ getVisibilityStatusLabel(selectedUser.profileVisibility) }}</p>
              </div>
            </div>
          </div>

          <!-- Informations système -->
          <div class="border-t pt-4">
            <h4 class="text-lg font-medium text-gray-800 mb-4">
              {{ 'ADMIN_USERS.MODAL.SYSTEM_INFO' | translate }}
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.CREATED_AT' | translate }}</label>
                <p class="text-gray-900">{{ selectedUser.createdAt }}</p>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">{{ 'ADMIN_USERS.MODAL.STATUS' | translate }}</label>
                <p class="text-gray-900">
                  <span [class]="selectedUser.status === 'active' ? 'text-green-600' : 'text-red-600'">
                    {{ selectedUser.status === 'active' ? 'Active' : 'Inactive' }}
                  </span>
                </p>
              </div>
            </div>
          </div>

          <!-- Bouton de fermeture -->
          <div class="flex justify-end pt-6 border-t">
            <button
              type="button"
              (click)="closeViewUserModal()"
              class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600">
              {{ 'ADMIN_USERS.MODAL.CLOSE' | translate }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit User Modal -->
  <div *ngIf="showEditUserModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
    <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
      <div class="p-6">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-semibold text-gray-800">
            {{ 'ADMIN_USERS.MODAL.EDIT_TITLE' | translate }}
          </h3>
          <button 
            (click)="closeEditUserModal()"
            class="text-gray-400 hover:text-gray-600 text-2xl">
            ×
          </button>
        </div>

        <form [formGroup]="editUserForm" (ngSubmit)="onEditSubmit()" class="space-y-6">
          <!-- Informations de base -->
          <div>
            <h4 class="text-lg font-medium text-gray-800 mb-4">
              {{ 'ADMIN_USERS.MODAL.BASIC_INFO' | translate }}
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.FIRST_NAME' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="firstName"
                  [class.border-red-500]="editUserForm.get('firstName')?.invalid && editUserForm.get('firstName')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.FIRST_NAME_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('firstName', editUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('firstName', editUserForm) }}
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.LAST_NAME' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="lastName"
                  [class.border-red-500]="editUserForm.get('lastName')?.invalid && editUserForm.get('lastName')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.LAST_NAME_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('lastName', editUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('lastName', editUserForm) }}
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.EMAIL' | translate }} *
                </label>
                <input
                  type="email"
                  formControlName="email"
                  [class.border-red-500]="editUserForm.get('email')?.invalid && editUserForm.get('email')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.EMAIL_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('email', editUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('email', editUserForm) }}
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.ROLE' | translate }} *
                </label>
                <select
                  formControlName="role"
                  class="cursor-pointer w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                  <option *ngFor="let role of getAvailableRoles()" [value]="role">
                    {{ role === 'student' ? 'Student' : 'Coach' }}
                  </option>
                </select>
              </div>
            </div>
          </div>

          <!-- Champs communs pour tous les rôles -->
          <div class="border-t pt-4">
            <h4 class="text-lg font-medium text-gray-800 mb-4">
              {{ 'ADMIN_USERS.MODAL.PERSONAL_INFO' | translate }}
            </h4>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.AGE' | translate }}
                </label>
                <input
                  type="number"
                  min="0"
                  max="100"
                  formControlName="age"
                  [class.border-red-500]="editUserForm.get('age')?.invalid && editUserForm.get('age')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.AGE_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('age', editUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('age', editUserForm) }}
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.GENDER' | translate }}
                </label>
                <select
                  formControlName="gender"
                  [ngClass]="{'text-gray-400': !editUserForm.get('gender')?.value}"
                  class="cursor-pointer bg-white w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                  <option [ngValue]="null" disabled selected hidden>{{ 'ADMIN_USERS.MODAL.SELECT_GENDER' | translate }}</option>
                  <option value="male">{{ 'ADMIN_USERS.MODAL.MALE' | translate }}</option>
                  <option value="female">{{ 'ADMIN_USERS.MODAL.FEMALE' | translate }}</option>
                  <option value="other">{{ 'ADMIN_USERS.MODAL.OTHER' | translate }}</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.PHONE_NUMBER' | translate }}
                </label>
                <input
                  type="tel"
                  formControlName="phoneNumber"
                  [class.border-red-500]="editUserForm.get('phoneNumber')?.invalid && editUserForm.get('phoneNumber')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.PHONE_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('phoneNumber', editUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('phoneNumber', editUserForm) }}
                </div>
              </div>
            </div>
          </div>

          <!-- Champs spécifiques aux étudiants -->
          <div *ngIf="isStudentRoleEdit()" class="border-t pt-4">
            <h4 class="text-lg font-medium text-gray-800 mb-4">
              {{ 'ADMIN_USERS.MODAL.STUDENT_INFO' | translate }}
            </h4>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.SCHOOL' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="school"
                  [class.border-red-500]="editUserForm.get('school')?.invalid && editUserForm.get('school')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.SCHOOL_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('school', editUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('school', editUserForm) }}
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.FIELD_OF_STUDY' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="fieldOfStudy"
                  [class.border-red-500]="editUserForm.get('fieldOfStudy')?.invalid && editUserForm.get('fieldOfStudy')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.FIELD_OF_STUDY_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('fieldOfStudy', editUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('fieldOfStudy', editUserForm) }}
                </div>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.EDUCATION_LEVEL_LABEL' | translate }} *
                </label>
                <select
                  formControlName="educationLevel"
                  [ngClass]="{'text-gray-400': !editUserForm.get('educationLevel')?.value}"
                  class="cursor-pointer bg-white w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                  <option value="" disabled selected hidden> {{ 'ADMIN_USERS.MODAL.SELECT_EDUCATION_LEVEL' | translate }}</option>
                  <option *ngFor="let level of educationLevels" [value]="level">
                    {{ getEducationLevelLabel(level) }}
                  </option>
                </select>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.CITY' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="city"
                  [class.border-red-500]="editUserForm.get('city')?.invalid && editUserForm.get('city')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.CITY_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('city', editUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('city', editUserForm) }}
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.REGION' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="region"
                  [class.border-red-500]="editUserForm.get('region')?.invalid && editUserForm.get('region')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.REGION_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('region', editUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('region', editUserForm) }}
                </div>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.COUNTRY' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="country"
                  [class.border-red-500]="editUserForm.get('country')?.invalid && editUserForm.get('country')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.COUNTRY_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('country', editUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('country', editUserForm) }}
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.ADDRESS' | translate }} *
                </label>
                <input
                  type="text"
                  formControlName="address"
                  [class.border-red-500]="editUserForm.get('address')?.invalid && editUserForm.get('address')?.touched"
                  class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  [placeholder]="'ADMIN_USERS.MODAL.ADDRESS_PLACEHOLDER' | translate"
                />
                <div *ngIf="getErrorMessage('address', editUserForm)" class="text-red-500 text-xs mt-1">
                  {{ getErrorMessage('address', editUserForm) }}
                </div>
              </div>
            </div>
          </div>

          <!-- Champs de permissions pour tous les rôles -->
          <div class="border-t pt-4">
            <h4 class="text-lg font-medium text-gray-800 mb-4">
              {{ 'ADMIN_USERS.MODAL.PERMISSIONS' | translate }}
            </h4>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.MESSAGE_PERMISSION_LABEL' | translate }}
                </label>
                <select
                  formControlName="messagePermission"
                  [ngClass]="{'text-gray-400': !editUserForm.get('messagePermission')?.value}"
                  class="cursor-pointer bg-white w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                  <option value="" disabled selected hidden>{{ 'ADMIN_USERS.MODAL.SELECT_PERMISSION' | translate }}</option>
                  <option *ngFor="let permission of messagePermissions" [value]="permission">
                    {{ getMessagePermissionLabel(permission) }}
                  </option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.ACCOUNT_PRIVACY_LABEL' | translate }}
                </label>
                <select
                  formControlName="accountPrivacy"
                  [ngClass]="{'text-gray-400': !editUserForm.get('accountPrivacy')?.value}"
                  class="cursor-pointer bg-white w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                  <option value="" disabled selected hidden>{{ 'ADMIN_USERS.MODAL.SELECT_ACCOUNT_PRIVACY' | translate }}</option>
                  <option *ngFor="let privacy of accountPrivacies" [value]="privacy">
                    {{ getAccountPrivacyLabel(privacy) }}
                  </option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  {{ 'ADMIN_USERS.MODAL.PROFILE_VISIBILITY_LABEL' | translate }}
                </label>
                <select
                  formControlName="profileVisibility"
                  [ngClass]="{'text-gray-400': !editUserForm.get('profileVisibility')?.value}"
                  class="cursor-pointer bg-white w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
                  <option value="" disabled selected hidden>{{ 'ADMIN_USERS.MODAL.SELECT_PROFILE_VISIBILITY' | translate }}</option>
                  <option *ngFor="let visibility of visibilityStatuses" [value]="visibility">
                    {{ getVisibilityStatusLabel(visibility) }}
                  </option>
                </select>
              </div>
            </div>
          </div>

          <!-- Boutons -->
          <div class="flex justify-end space-x-3 pt-6 border-t">
            <button
              type="button"
              (click)="closeEditUserModal()"
              class="px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50">
              {{ 'ADMIN_USERS.MODAL.CANCEL' | translate }}
            </button>
            <button
              type="submit"
              [disabled]="editUserForm.invalid"
              class="px-4 py-2 bg-brand-orange-dark text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 font-medium transition-colors">
              {{ 'ADMIN_USERS.MODAL.UPDATE' | translate }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
